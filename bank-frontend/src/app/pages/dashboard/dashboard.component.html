<header class="topbar">
  <h1>Open Banking</h1>
  <div class="right">
    <button class="add" (click)="openAddBank()">+ Banka Ekle</button>
    <button class="danger" (click)="logout()">Güvenli Çıkış</button>
  </div>
</header>

<!-- Banka Kartları -->
<div class="banks">
  <div
    class="bank-card"
    *ngFor="let b of banks()"
    [class.active]="selectedBank() === b.code"
    role="button"
    tabindex="0"
    (click)="selectBank(b.code)"
    (keyup.enter)="selectBank(b.code)"
  >
    <div class="row">
      <div class="logo">{{ b.name }}</div>
      <div class="mini">Connected</div>
    </div>

    <div class="balance" *ngIf="b.balanceTRY !== undefined">
      {{ b.balanceTRY | number:'1.2-2' }} TRY
    </div>
  </div>
</div>

<!-- Detay Paneli -->
<section *ngIf="selectedBank() as code" class="bank-detail">
  <div class="panel-header">
    <h2>{{ selectedBankName() }}</h2>
    <div class="spacer"></div>
    <button class="danger" (click)="logout()">Güvenli Çıkış</button>
  </div>

  <div class="grid">
    <!-- Hesaplar -->
    <div class="card">
      <h3>Hesaplarım</h3>

      <div class="acc" *ngFor="let a of accounts()">
        <div class="acc-left">
          <div class="name">{{ a.name }}</div>
          <div class="iban">{{ a.ibanMasked }}</div>
        </div>
        <div class="acc-right">
          <div class="bal">{{ a.balance | number:'1.2-2' }} {{ a.currency }}</div>
          <div class="actions">
            <button class="ghost">View</button>
            <button class="ghost">Transactions</button>
          </div>
        </div>
      </div>

      <div class="empty" *ngIf="accounts().length === 0">Hesap bulunamadı.</div>
    </div>

    <!-- Son İşlemler -->
    <div class="card">
      <h3>Son İşlemler</h3>

      <div class="tx" *ngFor="let t of recent()">
        <div class="left">
          <div class="desc">{{ t.description }}</div>
          <div class="date">{{ t.date | date:'short' }}</div>
        </div>
        <div class="amt" [class.minus]="t.amount < 0" [class.plus]="t.amount >= 0">
          {{ t.amount | number:'1.2-2' }} {{ t.currency }}
        </div>
      </div>

      <div class="empty" *ngIf="recent().length === 0">Gösterilecek işlem yok.</div>
    </div>
  </div>
</section>
